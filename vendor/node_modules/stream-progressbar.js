!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).progress=t()}}(function(){var t={};function e(t,e){if(this.stream=e.stream||process.stderr,"number"==typeof e){var r=e;(e={}).total=r}else{if(e=e||{},"string"!=typeof t)throw new Error("format required");if("number"!=typeof e.total)throw new Error("total required")}this.fmt=t,this.curr=e.curr||0,this.total=e.total,this.width=e.width||this.total,this.clear=e.clear,this.chars={complete:e.complete||"=",incomplete:e.incomplete||"-",head:e.head||e.complete||"="},this.renderThrottle=0!==e.renderThrottle?e.renderThrottle||16:0,this.lastRender=-1/0,this.callback=e.callback||function(){},this.tokens={},this.lastDraw=""}t=t=e,e.prototype.tick=function(t,e){if(0!==t&&(t=t||1),"object"==typeof t&&(e=t,t=1),e&&(this.tokens=e),0==this.curr&&(this.start=new Date),this.curr+=t,this.render(),this.curr>=this.total)return this.render(void 0,!0),this.complete=!0,this.terminate(),void this.callback(this)},e.prototype.render=function(t,e){if(e=void 0!==e&&e,t&&(this.tokens=t),this.stream.isTTY){var r=Date.now(),i=r-this.lastRender;if(e||!(i<this.renderThrottle)){this.lastRender=r;var s=this.curr/this.total;s=Math.min(Math.max(s,0),1);var a,o,n,h=Math.floor(100*s),l=new Date-this.start,c=100==h?0:l*(this.total/this.curr-1),f=this.curr/(l/1e3),p=this.fmt.replace(":current",this.curr).replace(":total",this.total).replace(":elapsed",isNaN(l)?"0.0":(l/1e3).toFixed(1)).replace(":eta",isNaN(c)||!isFinite(c)?"0.0":(c/1e3).toFixed(1)).replace(":percent",h.toFixed(0)+"%").replace(":rate",Math.round(f)),u=Math.max(0,this.stream.columns-p.replace(":bar","").length);u&&"win32"===process.platform&&(u-=1);var d=Math.min(this.width,u);if(n=Math.round(d*s),o=Array(Math.max(0,n+1)).join(this.chars.complete),a=Array(Math.max(0,d-n+1)).join(this.chars.incomplete),n>0&&(o=o.slice(0,-1)+this.chars.head),p=p.replace(":bar",o+a),this.tokens)for(var m in this.tokens)p=p.replace(":"+m,this.tokens[m]);this.lastDraw!==p&&(this.stream.cursorTo(0),this.stream.write(p),this.stream.clearLine(1),this.lastDraw=p)}}},e.prototype.update=function(t,e){var r=Math.floor(t*this.total)-this.curr;this.tick(r,e)},e.prototype.interrupt=function(t){this.stream.clearLine(),this.stream.cursorTo(0),this.stream.write(t),this.stream.write("\n"),this.stream.write(this.lastDraw)},e.prototype.terminate=function(){this.clear?this.stream.clearLine&&(this.stream.clearLine(),this.stream.cursorTo(0)):this.stream.write("\n")};var r=t,i=require("stream").PassThrough;return function(t,e){var s=new i(e=e||{}),a=e.total;return s.on("pipe",function(i){if(a){var o=new r(t,e);s.on("data",function(t){o.tick(t.length)})}else i.on("response",function(i){var a=parseInt(i.headers["content-length"],10);e.total=a;var o=new r(t,e);s.on("data",function(t){o.tick(t.length)})})}),s}});